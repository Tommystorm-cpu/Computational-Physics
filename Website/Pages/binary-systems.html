<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../CSS/index.css"/>
    <title>Home Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/bfdd83abfd.js" crossorigin="anonymous"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async
                src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
                </script>
  </head>

  <body class="gradient">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    
    <nav class="navbar navbar-expand-lg shadow-lg navbar-dark sticky-top" style="background-color: rgb(34, 34, 34)">
      <div class="container">
          <a class="navbar-brand" href="../../index.html">
            <img src="../Graphics/logo.png" alt="Home Button" width="65">
          </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item mx-3 nav-text">
                <a class="nav-link active text-white" aria-current="page" href="../../index.html">Home</a>
              </li>
              <li class="nav-item mx-3 nav-text">
                <a class="nav-link text-white" href="task-menu.html">Tasks</a>
              </li>
              <li class="nav-item mx-3 nav-text">
                <a class="nav-link text-white">Technical Report</a>
              </li>
              <li class="nav-item mx-3 nav-text">
                <a class="nav-link text-white">App Download</a>
              </li>
              <li class="nav-item mx-3 nav-text">
                <a class="nav-link d-lg-none text-white" target="_blank" href="https://github.com/Tommystorm-cpu/Computational-Physics">Github Repository</a>
              </li>
            </ul>
          </div>
          <a class="navbar-brand d-none d-lg-block" target="_blank" href="https://github.com/Tommystorm-cpu/Computational-Physics">
              <img src="../Graphics/github.png" alt="Github Button" width="50" height="50">
          </a>
      </div>
    </nav>

    <div class="mx-auto container mt-3" style="max-width: 40rem; width: 90%;">
    <div class="row">
      <a class="btn btn-primary col my-auto" href="task7.html"><i class="fa-solid fa-caret-down fa-rotate-90"></i> Task 7</a>
      <h5 class="col text-white text-center my-auto">Binary Systems</h5>
      <a class="btn btn-primary col my-auto" href="goldilocks-zone.html">Goldilocks Zone <i class="fa-solid fa-caret-down fa-rotate-270"></i></a>
    </div>
  </div>

  <py-config type="toml" class="m-0" style="visibility: hidden; height: 0%; position: absolute; z-index: -5;"> 
    packages = ["matplotlib", "numpy"] 
    
    [[fetch]]
    from = '../Python'
    files = ["Binary_systems_web.py"]
  </py-config>

  <div class="card task-content mx-auto bg-white mt-5" id="runArea" style="visibility: hidden; z-index: -5; position: absolute;">
    
    <label for="mass1" class="form-label">Mass of Star 1</label>
    <input type="range" class="form-range w-50" min="0" max="10" step="1" id="mass1">

    <label for="mass2" class="form-label">Mass of Star 2</label>
    <input type="range" class="form-range w-50" min="0" max="10" step="1" id="mass2">

    <label for="semiMajor" class="form-label">Semi Major</label>
    <input type="range" class="form-range w-50" min="0" max="10" step="1" id="semiMajor">

    <label for="startDistance" class="form-label">Planet Starting Distance</label>
    <input type="range" class="form-range w-50" min="0" max="10" step="1" id="startDistance">

    <label for="velocity" class="form-label">Initial Velocity Multiplier</label>
    <input type="range" class="form-range w-50" min="-2" max="2" step="0.1" id="velocity">

    <div class="form-check form-switch">
      <input class="form-check-input" type="checkbox" role="switch" id="starOrbit">
      <label class="form-check-label" for="starOrbit">Star to orbit</label>
    </div>

    <button type="button" class="btn btn-primary" py-click="load_solar()">Create Image</button>
    
    
    <div id="graph-area" class="d-flex align-items-center"></div>

    <py-script>
        import Binary_systems_web as BSW
        import js
        import matplotlib.pyplot as plt

        def load_solar():
            star1M = int(Element("mass1").value)
            star2M = int(Element("mass2").value)
            semi_major = int(Element("semiMajor").value)
            planet_start_distance = float(Element("startDistance").value)
            initv = float(Element("velocity").value)
            """
            if Element("starOrbit").checked == "on":
              starOrbit = 1
            else:
              starOrbit = 2
            """
            starOrbit = int(js.document.querySelector("#starOrbit").checked) + 1

            fig = BSW.binary_systems(semi_major, planet_start_distance, star1M, star2M, initv, starOrbit)
            #fig = BSW.binary_systems(3, 5, 1, 2, 1, 1)
            display(fig, target="graph-area", append=False)
            js.formatImage()
            plt.close(fig)
    </py-script>
    
    <script>
        function formatImage () {
            const graphArea = document.getElementById("graph-area");
            const child = graphArea.children[0];
            child.classList.add("img-fluid");
            child.classList.add("m-auto");
        }
    </script>
</div>

<div class="card d-flex align-items-center mx-auto bg-white task-content mt-5" id="buttonArea">
    <button id="runButton" class="card-body btn btn-primary mx-auto my-5">Run in browser <i class="fa-solid fa-play"></i></button>
    <script>
        const runButton = document.getElementById("runButton");
        const runArea = document.getElementById("runArea");
        const buttonArea = document.getElementById("buttonArea");
        const header = document.getElementsByTagName("head")[0];
        runButton.onclick = () => {
            runArea.style.visibility = "visible"
            runArea.style.position = "relative"
            runArea.style.zIndex = "0"
            runArea.classList.add("mt-5")

            let pyLink = document.createElement('link');
            let pyScript  = document.createElement('script');
            pyLink.rel = "stylesheet"
            pyLink.href = "https://pyscript.net/latest/pyscript.css"
            pyScript.src = "https://pyscript.net/latest/pyscript.js"
            pyScript.defer = true;
            header.appendChild(pyLink)
            header.appendChild(pyScript)
            buttonArea.remove();
        }
    </script>
</div>

<div class="mx-auto my-5 card task-content">
  <div class="d-flex flex-wrap justify-content-center" style="width: 100%;">
    <p class="text-left mx-3 my-auto py-3" style="width: 40rem;">
      The Binary systems model shows a system such that there are 2 stars of arbitrary mass( measured in solar masses) and 1 planet where the mass is treated as negligible.
      The planets have an inital seperation equal to their semi-major axis(a) and the distance from the center of mass of the 2 stars to each star is determined from the following equations:
      $$r_{1} = a\frac{M1}{M1 + M2}$$
      $$r_2 = a - r_1$$
      Time increments in small steps, where at each step acceleration for both stars and the planet is calculated using newtons law of gravitation:
      $$a_{n,i} = -G\sum_{j\ne i}^{N}M_j\frac{r_i-r_j}{\left|r_i-r_j \right|^3}$$
      The new position of each planet is then calculated using the verlet method shown below:
      $$a_n = f(t_n, r_n, v_n)$$
      $$t_{n+1} = t_n +\Delta t$$
      $$r_{n+1} = r_n + v_n\Delta t + \frac{1}{2}a_n\Delta t^2$$
      $$V = v_n + a_n\Delta t$$
      $$A = f(t_{n+1}, r_{n+1}, V)$$
      $$v_{n+1} = v_n + \frac{1}{2}(a_n +A)\Delta t$$
      The time then continues incrementing until a set number of orbits has been achieved. The orbital paths are then plotted and outputted as a graph.
      The model can also be animated and an example video accompanies this page to demonstrate the animated model.
      <br>
      <br>
      Note: Due to issues with Python animation website integration, a .mp4 file of an example animation is presented to the user, whom we  invite to download the python file if they wish (all Python files can be found within the Task files folder of the Github Repository).
    </p>

    <div id="imageCarousel" class="carousel slide mx-3" data-bs-theme="dark" style="width: 40%; min-width: 18rem;">
      <div class="carousel-inner rounded-3">
        <div class="carousel-item active">
          <img src="../Graphics/Binarypreview1.png" class="d-block w-100" alt="...">
        </div>
        <div class="carousel-item">
          <img src="../Graphics/Binarypreview2.png" class="d-block w-100" alt="...">
        </div>
        <div class="carousel-item">
          <img src="../Graphics/Binarypreview3.png" class="d-block w-100" alt="...">
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#imageCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#imageCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  </div>

  <p class="mt-5 py-3 mx-auto text-center">
    Example images to show possible results of the binary systems model.


  </p>
</div>

<footer class="footer" style="background-color: rgb(34, 34, 34)">
  <div class="container-fluid">
    <div class="row">
      <p class="footer-text col mt-2">
        This website was created for the 2023 BPhO Computational Physics Challenge, by Thomas Davey and Alex Arnold.
      </p>
      <p class="footer-text col text-end mt-2">August 14th 2023</p>
    </div>
  </div>
</footer>

</body>
</html>
